#!/usr/bin/php

index pub_base {
	type 				= rt
	path 				= /var/lib/manticore/pub/rt_pub_base

	rt_mem_limit 		= 4096M

	rt_attr_uint		= pub_id
	rt_attr_string		= pub_name
	rt_attr_string		= start_segment
	rt_attr_string		= end_segment
	rt_field			= text
	rt_attr_timestamp	= date
	rt_attr_timestamp	= created
	
	morphology			= lemmatize_en
	#exceptions			= /etc/manticoresearch/articles_exceptions.txt

	charset_table = U+0040, U+0023, U+002B, U+0026, 0..9, a..z, _, A..Z->a..z, U+0621, U+0624, U+0626, U+0627, U+0628, U+062A..U+063A, U+0641..U+0648, U+064A, U+067E, U+0686, U+0688, U+0691, U+0698, U+06AF, U+06BA, U+06BB, U+0660..U+0669->0..9, U+06F0..U+06F9->0..9, U+0622->U+0627, U+0623->U+0627, U+0625->U+0627, U+0629->U+0647, U+0649->U+064A, U+0671->U+0627, U+0672->U+0627, U+0673->U+0627, U+0675->U+0627, U+0676->U+0624, U+0677->U+0624, U+066E->U+0628, U+067B->U+0628, U+0680->U+0628, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+067A->U+062A, U+067B->U+062A, U+067C->U+062A, U+067D->U+062A, U+067F->U+062A, U+0680->U+062A, U+0681->U+062D, U+0682->U+062D, U+0683->U+062D, U+0684->U+062D, U+0685->U+062D, U+0687->U+0686, U+06BF->U+0686, U+0689->U+062F, U+068A->U+062F, U+068C->U+062F, U+068D->U+062F, U+068E->U+062F, U+068F->U+062F, U+0690->U+062F, U+06EE->U+062F, U+068B->U+0688, U+0692->U+0631, U+0693->U+0631, U+0694->U+0631, U+0695->U+0631, U+0696->U+0631, U+0697->U+0631, U+0699->U+0631, U+06EF->U+0631, U+069A->U+0633, U+069B->U+0633, U+069C->U+0633, U+06FA->U+0633, U+069D->U+0635, U+069E->U+0635, U+06FB->U+0635, U+069F->U+0637, U+06A0->U+0639, U+06FC->U+0639, U+06A1->U+0641, U+06A2->U+0641, U+06A3->U+0641, U+06A4->U+0641, U+06A5->U+0641, U+06A6->U+0641, U+066F->U+0642, U+06A7->U+0642, U+06A8->U+0642, U+063B->U+0643, U+063C->U+0643, U+06A9->U+0643, U+06AA->U+0643, U+06AB->U+0643, U+06AC->U+0643, U+06AD->U+0643, U+06AE->U+0643, U+06B0->U+06AF, U+06B1->U+06AF, U+06B2->U+06AF, U+06B3->U+06AF, U+06B4->U+06AF, U+06B5->U+0644, U+06B6->U+0644, U+06B7->U+0644, U+06B8->U+0644, U+06FE->U+0645, U+06B9->U+0646, U+06BC->U+0646, U+06BD->U+0646, U+06BE->U+0647, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+06D5->U+0647, U+06FF->U+0647, U+06C4->U+0648, U+06C5->U+0648, U+06C6->U+0648, U+06C7->U+0648, U+06C8->U+0648, U+06C9->U+0648, U+06CA->U+0648, U+06CB->U+0648, U+06CF->U+0648, U+063D->U+064A, U+063E->U+064A, U+063F->U+064A, U+06CC->U+064A, U+06CD->U+064A, U+06CE->U+064A, U+06D0->U+064A, U+06D1->U+064A, U+06D2->U+064A, U+06D3->U+064A, U+0676->U+0624, U+0677->U+0624, U+0674->U+0621

	ignore_chars 		= U+0640, U+064B..U+065F,U+06D6..U+06DC,U+06DF..U+06E8,U+06EA..U+06ED

	min_infix_len		= 2
	embedded_limit		= 32K
	ngram_len 			= 1
	html_strip			= 1
}


<?php
	$servername = "192.168.1.118";
	$username = "app_user";
	$password = "UFGBsfrhjuj42";
	$dbname = "recordings_text";

	$conn = mysqli_connect($servername, $username, $password, $dbname);
	if (!$conn){
		die("Connection failed: " . mysqli_connect_error());
	}
	
	$sql = "SELECT table_name FROM information_schema.tables WHERE table_type = 'base table' AND table_schema='recordings_text' and table_name like '%pub_%'";
	if (!$result = $conn->query($sql)) {
		echo "Query: " . $sql . "\n";
		echo "Error: " . $conn->error . "\n";
		exit;
	}

	while ($tbl = $result->fetch_assoc())
	{
?>
index <?php echo $tbl['table_name']; ?> : pub_base {
	path = /var/lib/manticore/pub/rt_<?php echo $tbl['table_name'] . "\n"; ?>
}
<?php
	}
?>


index rt_page_index
{
	type 				= rt
	path 				= /var/lib/manticore/page_text/rt_page_index

	rt_mem_limit 		= 4096M

	rt_attr_uint		= publication_id
 	rt_attr_uint		= section_id
 	rt_attr_uint		= page_id
 	rt_attr_string		= page_name
	rt_attr_string		= publication_name
	rt_attr_string		= section_name
	rt_attr_string		= country
 	rt_attr_timestamp	= issue_date
	rt_field			= text
	rt_attr_timestamp	= created	
	
	#morphology = stem_ar, stem_en

	morphology			= lemmatize_en
	min_word_len 		= 1

	charset_table 		= U+0040, U+0023, U+002B, U+0026, 0..9, a..z, _, A..Z->a..z, U+0621, U+0624, U+0626, U+0627, U+0628, U+062A..U+063A, U+0641..U+0648, U+064A, U+067E, U+0686, U+0688, U+0691, U+0698, U+06AF, U+06BA, U+06BB, U+0660..U+0669->0..9, U+06F0..U+06F9->0..9, U+0622->U+0627, U+0623->U+0627, U+0625->U+0627, U+0629->U+0647, U+0649->U+064A, U+0671->U+0627, U+0672->U+0627, U+0673->U+0627, U+0675->U+0627, U+0676->U+0624, U+0677->U+0624, U+066E->U+0628, U+067B->U+0628, U+0680->U+0628, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+067A->U+062A, U+067B->U+062A, U+067C->U+062A, U+067D->U+062A, U+067F->U+062A, U+0680->U+062A, U+0681->U+062D, U+0682->U+062D, U+0683->U+062D, U+0684->U+062D, U+0685->U+062D, U+0687->U+0686, U+06BF->U+0686, U+0689->U+062F, U+068A->U+062F, U+068C->U+062F, U+068D->U+062F, U+068E->U+062F, U+068F->U+062F, U+0690->U+062F, U+06EE->U+062F, U+068B->U+0688, U+0692->U+0631, U+0693->U+0631, U+0694->U+0631, U+0695->U+0631, U+0696->U+0631, U+0697->U+0631, U+0699->U+0631, U+06EF->U+0631, U+069A->U+0633, U+069B->U+0633, U+069C->U+0633, U+06FA->U+0633, U+069D->U+0635, U+069E->U+0635, U+06FB->U+0635, U+069F->U+0637, U+06A0->U+0639, U+06FC->U+0639, U+06A1->U+0641, U+06A2->U+0641, U+06A3->U+0641, U+06A4->U+0641, U+06A5->U+0641, U+06A6->U+0641, U+066F->U+0642, U+06A7->U+0642, U+06A8->U+0642, U+063B->U+0643, U+063C->U+0643, U+06A9->U+0643, U+06AA->U+0643, U+06AB->U+0643, U+06AC->U+0643, U+06AD->U+0643, U+06AE->U+0643, U+06B0->U+06AF, U+06B1->U+06AF, U+06B2->U+06AF, U+06B3->U+06AF, U+06B4->U+06AF, U+06B5->U+0644, U+06B6->U+0644, U+06B7->U+0644, U+06B8->U+0644, U+06FE->U+0645, U+06B9->U+0646, U+06BC->U+0646, U+06BD->U+0646, U+06BE->U+0647, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+06D5->U+0647, U+06FF->U+0647, U+06C4->U+0648, U+06C5->U+0648, U+06C6->U+0648, U+06C7->U+0648, U+06C8->U+0648, U+06C9->U+0648, U+06CA->U+0648, U+06CB->U+0648, U+06CF->U+0648, U+063D->U+064A, U+063E->U+064A, U+063F->U+064A, U+06CC->U+064A, U+06CD->U+064A, U+06CE->U+064A, U+06D0->U+064A, U+06D1->U+064A, U+06D2->U+064A, U+06D3->U+064A, U+0676->U+0624, U+0677->U+0624, U+0674->U+0621

	ignore_chars 		= U+0640, U+064B..U+065F,U+06D6..U+06DC,U+06DF..U+06E8,U+06EA..U+06ED
	
	min_infix_len		= 2
	embedded_limit		= 32K
	ngram_len 			= 1
	blend_chars			= U+27, U+2019, U+60
	blend_mode			= trim_none, skip_pure
	html_strip			= 1

}



index articles_test {
	type 				= rt
	path 				= /var/lib/manticore/articles_test

	rt_mem_limit 		= 4096M

	rt_attr_uint		= id_crawl_article
	rt_attr_uint		= id_queue
	rt_attr_uint		= id_site
	rt_attr_uint		= id_site_section
	rt_field			= headline
	rt_field			= content
	rt_field			= country
	rt_field			= language
	rt_field			= site_name
	rt_attr_multi		= keyword_ids
	rt_attr_string		= author
	rt_attr_string		= link
	rt_attr_timestamp	= article_date
	rt_attr_timestamp	= created

	morphology			= lemmatize_en
	#exceptions			= /etc/manticoresearch/articles_exceptions.txt

	charset_table = U+0040, U+0023, U+002B, U+0026, 0..9, a..z, _, A..Z->a..z, U+0621, U+0624, U+0626, U+0627, U+0628, U+062A..U+063A, U+0641..U+0648, U+064A, U+067E, U+0686, U+0688, U+0691, U+0698, U+06AF, U+06BA, U+06BB, U+0660..U+0669->0..9, U+06F0..U+06F9->0..9, U+0622->U+0627, U+0623->U+0627, U+0625->U+0627, U+0629->U+0647, U+0649->U+064A, U+0671->U+0627, U+0672->U+0627, U+0673->U+0627, U+0675->U+0627, U+0676->U+0624, U+0677->U+0624, U+066E->U+0628, U+067B->U+0628, U+0680->U+0628, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+067A->U+062A, U+067B->U+062A, U+067C->U+062A, U+067D->U+062A, U+067F->U+062A, U+0680->U+062A, U+0681->U+062D, U+0682->U+062D, U+0683->U+062D, U+0684->U+062D, U+0685->U+062D, U+0687->U+0686, U+06BF->U+0686, U+0689->U+062F, U+068A->U+062F, U+068C->U+062F, U+068D->U+062F, U+068E->U+062F, U+068F->U+062F, U+0690->U+062F, U+06EE->U+062F, U+068B->U+0688, U+0692->U+0631, U+0693->U+0631, U+0694->U+0631, U+0695->U+0631, U+0696->U+0631, U+0697->U+0631, U+0699->U+0631, U+06EF->U+0631, U+069A->U+0633, U+069B->U+0633, U+069C->U+0633, U+06FA->U+0633, U+069D->U+0635, U+069E->U+0635, U+06FB->U+0635, U+069F->U+0637, U+06A0->U+0639, U+06FC->U+0639, U+06A1->U+0641, U+06A2->U+0641, U+06A3->U+0641, U+06A4->U+0641, U+06A5->U+0641, U+06A6->U+0641, U+066F->U+0642, U+06A7->U+0642, U+06A8->U+0642, U+063B->U+0643, U+063C->U+0643, U+06A9->U+0643, U+06AA->U+0643, U+06AB->U+0643, U+06AC->U+0643, U+06AD->U+0643, U+06AE->U+0643, U+06B0->U+06AF, U+06B1->U+06AF, U+06B2->U+06AF, U+06B3->U+06AF, U+06B4->U+06AF, U+06B5->U+0644, U+06B6->U+0644, U+06B7->U+0644, U+06B8->U+0644, U+06FE->U+0645, U+06B9->U+0646, U+06BC->U+0646, U+06BD->U+0646, U+06BE->U+0647, U+06C0->U+0647, U+06C1->U+0647, U+06C2->U+0647, U+06C3->U+0647, U+06D5->U+0647, U+06FF->U+0647, U+06C4->U+0648, U+06C5->U+0648, U+06C6->U+0648, U+06C7->U+0648, U+06C8->U+0648, U+06C9->U+0648, U+06CA->U+0648, U+06CB->U+0648, U+06CF->U+0648, U+063D->U+064A, U+063E->U+064A, U+063F->U+064A, U+06CC->U+064A, U+06CD->U+064A, U+06CE->U+064A, U+06D0->U+064A, U+06D1->U+064A, U+06D2->U+064A, U+06D3->U+064A, U+0676->U+0624, U+0677->U+0624, U+0674->U+0621

	ignore_chars 		= U+0640, U+064B..U+065F,U+06D6..U+06DC,U+06DF..U+06E8,U+06EA..U+06ED

	min_infix_len		= 2
	embedded_limit		= 32K
	ngram_len 			= 1
	html_strip			= 1
}


index pqtest:articles_test {
	type 				= percolate
	path 				= /var/lib/manticore/pqtest
}




#############################################################################
## indexer settings
#############################################################################

indexer
{
	# memory limit, in bytes, kiloytes (16384K) or megabytes (256M)
	# optional, default is 128M, max is 2047M, recommended is 256M to 1024M
	mem_limit		= 1024M

	# maximum IO calls per second (for I/O throttling)
	# optional, default is 0 (unlimited)
	#
	max_iops		= 60


	# maximum IO call size, bytes (for I/O throttling)
	# optional, default is 0 (unlimited)
	#
	max_iosize		= 1048576


	# maximum xmlpipe2 field length, bytes
	# optional, default is 2M
	#
	# max_xmlpipe2_field	= 4M


	# write buffer size, bytes
	# several (currently up to 4) buffers will be allocated
	# write buffers are allocated in addition to mem_limit
	# optional, default is 1M
	#
	# write_buffer		= 1M


	# maximum file field adaptive buffer size
	# optional, default is 8M, minimum is 1M
	#
	# max_file_field_buffer	= 32M


	# how to handle IO errors in file fields
	# known values are 'ignore_field', 'skip_document', and 'fail_index'
	# optional, default is 'ignore_field'
	#
	# on_file_field_error = skip_document


	# how to handle syntax errors in JSON attributes
	# known values are 'ignore_attr' and 'fail_index'
	# optional, default is 'ignore_attr'
	#
	# on_json_attr_error = fail_index


	# whether to auto-convert numeric values from strings in JSON attributes
	# with auto-conversion, string value with actually numeric data
	# (as in {"key":"12345"}) gets stored as a number, rather than string
	# optional, allowed values are 0 and 1, default is 0 (do not convert)
	#
	# json_autoconv_numbers = 1


	# whether and how to auto-convert key names in JSON attributes
	# known value is 'lowercase'
	# optional, default is unspecified (do nothing)
	#
	# json_autoconv_keynames = lowercase


	# lemmatizer cache size
	# improves the indexing time when the lemmatization is enabled
	# optional, default is 256K
	#
	lemmatizer_cache = 512M
}

#############################################################################
## searchd settings
#############################################################################

searchd
{
	listen				= 9312
	listen				= 9306:mysql41
	log					= /var/log/manticore/searchd.log
	query_log			= /var/log/manticore/query.log
	
	mysql_version_string = 5.0.37

	client_timeout		= 300
	persistent_connections_limit	= 30

	pid_file			= /var/run/manticore/searchd.pid
	
	binlog_path			= /var/lib/manticore
	seamless_rotate		= 1
	preopen_indexes		= 1
	unlink_old			= 1
	max_packet_size		= 8M
	max_filters			= 256
	max_filter_values	= 4096
	max_batch_queries	= 32

	threads 			= 8
}

#############################################################################
## common settings
#############################################################################

common
{

	# lemmatizer dictionaries base path
	# optional, defaut is /usr/local/share (see ./configure --datadir)
	#
	# lemmatizer_base = /usr/local/share/sphinx/dicts
	lemmatizer_base = /usr/share/manticore/dicts

	# path to RLP root directory
	# optional, defaut is /usr/local/share (see ./configure --datadir)
	#
	# rlp_root = /usr/local/share/sphinx/rlp

	# path to RLP environment file
	# optional, defaut is /usr/local/share/rlp-environment.xml (see ./configure --datadir)
	#
	# rlp_environment = /usr/local/share/sphinx/rlp/rlp/etc/rlp-environment.xml
}

# --eof--
